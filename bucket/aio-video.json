{
    "version": "0.1",
    "description": "ðŸ“¦ All-In-One solution for ffmpeg, LosslessCut and blur",
    "homepage": "https://github.com/couleur-tweak-tips/AIO-Video",
    "license": "GPL-3.0",
    "url": "https://github.com/couleur-tweak-tips/AIO-Video/archive/refs/heads/main.zip",
    "hash": "6AA7D32F0127D1704D46EB3A86C88776D4AE3BD42890B0BAD8D2A1BA59039649",
    "pre_install": [
        "Set-ExecutionPolicy Bypass -Scope Process -Force",
        "[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072",
        "Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/couleur-tweak-tips/utils/main/Miscellaneous/funcs.ps1'))",

        "if(-Not(Get-Path wt.exe)){scoop install https://raw.githubusercontent.com/ScoopInstaller/Extras/master/bucket/windows-terminal.json",
        "if(-Not(Get-Path pwsh.exe)){scoop install https://raw.githubusercontent.com/ScoopInstaller/main/master/bucket/pwsh.json",
        "if(-Not(Get-Path ffprogress.exe)){scoop install https://raw.githubusercontent.com/couleur-tweak-tips/main/main/scoop-bucket/ffprogress.json",
        "if(-Not(Get-Path \"${env:ProgramFiles(x86)}\\blur\\blur.exe\")){scoop install https://raw.githubusercontent.com/couleur-tweak-tips/main/main/scoop-bucket/blur.json",

        "$Main=(Join-Path ((Get-Command scoop.cmd).source | Split-Path | Split-Path) apps\\AIO-Video\\current\\Main.ps1)",
        "$Main= $Main.Trim('\"')"
    ],
    "bin": [
        [
            "explorer.exe",
            "av",
            "-ep bypass -command & 'Main'"
        ]
    ],
    "post_install": [
        "$shims = (Get-Command scoop.cmd).Source | Split-Path",
        "if (Get-Process -Name AV.exe -ErrorAction SilentlyContinue){Stop-Process -Name AV -ErrorAction Inquire}",
        "@(\"$shims\\av.ps1\",\"$shims\\av.shim\") | ForEach-Object {(Get-Content $_) -replace ('Main',\"$Main\") | Set-Content $_}",

        "@\"",
        "@echo off",
        "setlocal enabledelayedexpansion",
        "set args=%*",
        ":: replace problem characters in arguments",
        "set args=%args:\"='%",
        "set args=%args:(=`(%",
        "set args=%args:)=`)%",
        "set invalid=\"='",
        "if !args! == !invalid! ( set args= )",
        "powershell -noprofile -ex unrestricted \"& '$Main' -CommandLine\"",
        "\"@ | Set-Content \"$shims\\av.cmd\"",

        "$permanentDir = Join-Path ($dir | Split-Path) current",
        "New-Shortcut -Path \"$shims\\av.lnk\" -TargetPath \"$(Get-Path wt.exe)\" -IconLocation \"$permanentDir\\av.ico\" -Interactive -Arguments \"-w 0 $(Get-Path pwsh.exe) -NoProfile -ExecutionPolicy Bypass-NoLogo -File \"$Main\" -Run",
        "@(\"$([Environment]::GetFolderPath('SendTo'))\\AIO-Video.lnk\",\"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\AIO-Video.lnk\",\"$env:ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\AIO-Video.lnk\",\"$env:APPDATA\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\\AIO-Video.lnk\")",
        "| ForEach-Object {New-Shortcut -Path $_ -TargetPath \"$(Get-Path wt.exe)\" -IconLocation \"$permanentDir\\av.ico\" -Interactive -Arguments \"-w 0 $(Get-Path pwsh.exe) -NoProfile -ExecutionPolicy Bypass-NoLogo -File \"$Main\"}"
        ]


}